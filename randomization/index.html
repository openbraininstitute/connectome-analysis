
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../modelling/">
      
      
        <link rel="next" href="../network_topology/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Randomization - connalysis</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#this-page-describes-functions-contained-in-the-randomization-module-used-to-generate-of-randomized-controls-of-connectomes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="connalysis" class="md-header__button md-logo" aria-label="connalysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            connalysis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Randomization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openbraininstitute/connectome-analysis.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="connalysis" class="md-nav__button md-logo" aria-label="connalysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    connalysis
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openbraininstitute/connectome-analysis.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modelling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Randomization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Randomization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#this-page-describes-functions-contained-in-the-randomization-module-used-to-generate-of-randomized-controls-of-connectomes" class="md-nav__link">
    <span class="md-ellipsis">
      This page describes functions contained in the randomization module used to generate of randomized controls of connectomes.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization" class="md-nav__link">
    <span class="md-ellipsis">
      randomization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.ER_model" class="md-nav__link">
    <span class="md-ellipsis">
      ER_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.ER_shuffle" class="md-nav__link">
    <span class="md-ellipsis">
      ER_shuffle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization._seed_random_state" class="md-nav__link">
    <span class="md-ellipsis">
      _seed_random_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.add_connections" class="md-nav__link">
    <span class="md-ellipsis">
      add_connections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.add_rc_connections" class="md-nav__link">
    <span class="md-ellipsis">
      add_rc_connections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.add_rc_connections_skeleta" class="md-nav__link">
    <span class="md-ellipsis">
      add_rc_connections_skeleta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.adjusted_ER" class="md-nav__link">
    <span class="md-ellipsis">
      adjusted_ER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.bishuffled_model" class="md-nav__link">
    <span class="md-ellipsis">
      bishuffled_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.configuration_model" class="md-nav__link">
    <span class="md-ellipsis">
      configuration_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2_block" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2_block
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2_block_pre" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2_block_pre
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2_model" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD3" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_ER" class="md-nav__link">
    <span class="md-ellipsis">
      run_ER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_SBM" class="md-nav__link">
    <span class="md-ellipsis">
      run_SBM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.underlying_model" class="md-nav__link">
    <span class="md-ellipsis">
      underlying_model
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_topology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_classic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_local/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stats
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#this-page-describes-functions-contained-in-the-randomization-module-used-to-generate-of-randomized-controls-of-connectomes" class="md-nav__link">
    <span class="md-ellipsis">
      This page describes functions contained in the randomization module used to generate of randomized controls of connectomes.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization" class="md-nav__link">
    <span class="md-ellipsis">
      randomization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.ER_model" class="md-nav__link">
    <span class="md-ellipsis">
      ER_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.ER_shuffle" class="md-nav__link">
    <span class="md-ellipsis">
      ER_shuffle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization._seed_random_state" class="md-nav__link">
    <span class="md-ellipsis">
      _seed_random_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.add_connections" class="md-nav__link">
    <span class="md-ellipsis">
      add_connections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.add_rc_connections" class="md-nav__link">
    <span class="md-ellipsis">
      add_rc_connections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.add_rc_connections_skeleta" class="md-nav__link">
    <span class="md-ellipsis">
      add_rc_connections_skeleta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.adjusted_ER" class="md-nav__link">
    <span class="md-ellipsis">
      adjusted_ER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.bishuffled_model" class="md-nav__link">
    <span class="md-ellipsis">
      bishuffled_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.configuration_model" class="md-nav__link">
    <span class="md-ellipsis">
      configuration_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2_block" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2_block
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2_block_pre" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2_block_pre
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD2_model" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD2_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_DD3" class="md-nav__link">
    <span class="md-ellipsis">
      run_DD3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_ER" class="md-nav__link">
    <span class="md-ellipsis">
      run_ER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.run_SBM" class="md-nav__link">
    <span class="md-ellipsis">
      run_SBM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.randomization.randomization.underlying_model" class="md-nav__link">
    <span class="md-ellipsis">
      underlying_model
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Randomization</h1>

<h2 id="this-page-describes-functions-contained-in-the-randomization-module-used-to-generate-of-randomized-controls-of-connectomes">This page describes functions contained in the <code>randomization</code> module used to generate of randomized controls of connectomes.</h2>


<div class="doc doc-object doc-module">



<a id="src.connalysis.randomization.randomization"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.ER_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ER_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates an Erdos Renyi digraph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>sparse matrix or 2d-array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used to generate model</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If adj is not square</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ER_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an Erdos Renyi digraph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : sparse matrix or 2d-array</span>
<span class="sd">        Adjacency matrix</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used to generate model</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>


<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If adj is not square</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;The matrix is not square&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="p">((</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
      <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">run_ER</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.ER_shuffle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ER_shuffle</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">neuron_properties</span><span class="o">=</span><span class="p">[],</span> <span class="n">shuffle_type</span><span class="o">=</span><span class="s1">&#39;sparse&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates an Erdős Renyi digraph with exactly the same number of edges and weights
as adj by shuffling the non-diagonla entries of adj.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>sparse matrix or 2d array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base digraph for which the ER control is built.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shuffle_type</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>dense</code> if first converts adj to a dense array and then shuffle.
If <code>sparse</code> it keeps sparsity during the shuffle.</p>
              </div>
            </td>
            <td>
                  <code>&#39;sparse&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If adj is not not sparse and <code>shuffle_type</code> is set to sparse.  A sparse shuffle can only be done to a sparse matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@_seed_random_state</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ER_shuffle</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">neuron_properties</span><span class="o">=</span><span class="p">[],</span> <span class="n">shuffle_type</span><span class="o">=</span><span class="s2">&quot;sparse&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an Erdős Renyi digraph with exactly the same number of edges and weights</span>
<span class="sd">    as adj by shuffling the non-diagonla entries of adj.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : sparse matrix or 2d array</span>
<span class="sd">        Base digraph for which the ER control is built.</span>
<span class="sd">    shuffle_type : string</span>
<span class="sd">        If ``dense`` if first converts adj to a dense array and then shuffle.</span>
<span class="sd">        If ``sparse`` it keeps sparsity during the shuffle.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If adj is not not sparse and ``shuffle_type`` is set to sparse.  A sparse shuffle can only be done to a sparse matrix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">shuffle_type</span> <span class="o">==</span> <span class="s2">&quot;dense&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">adj</span><span class="p">):</span>
            <span class="n">adj</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
        <span class="n">above_diagonal</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">below_diagonal</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">off_diagonal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">above_diagonal</span><span class="p">,</span> <span class="n">below_diagonal</span><span class="p">])</span>

        <span class="c1"># Shuffle away from the diagonal</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">off_diagonal</span><span class="p">)</span>
        <span class="n">adj</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">off_diagonal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">adj</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">off_diagonal</span><span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span>
        <span class="c1"># Return matrix</span>
        <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shuffle_type</span> <span class="o">==</span> <span class="s2">&quot;sparse&quot;</span><span class="p">:</span>
        <span class="c1"># Keep matrix sparse</span>
        <span class="k">assert</span> <span class="n">sp</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">adj</span><span class="p">),</span> <span class="s2">&quot;Matrix must be sparse for sparse shuffle&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">data</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">nnz</span>  <span class="c1"># number of non zero entries</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># number of entries away from the diagonal</span>

        <span class="c1"># Select K entries in np.arange(T) representing the indices of the array of</span>
        <span class="c1"># pairs of tuples of entries away from the diagonal</span>
        <span class="c1"># [(0,1), (0,2), (0,3), ...,(0,n),</span>
        <span class="c1">#  (1,0) (1,2) (1,3) ... (1,n),</span>
        <span class="c1"># ....</span>
        <span class="c1">#  (n,0) (n,1) (n,2) ... (n,n-1)]</span>
        <span class="n">rnd_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get corresponding row and column indices</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">rnd_index</span> <span class="o">//</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># row indices</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">rnd_index</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># colum indices candidates shifted by 1</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># column indices</span>

        <span class="c1"># Return matrix</span>
        <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization._seed_random_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_seed_random_state</span><span class="p">(</span><span class="n">shuffler</span><span class="p">,</span> <span class="n">seeder</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Decorate a connectivity shuffler to seed it's random-state before execution.</p>
<p>It is expected that the generator can be seeded calling <code>seeder(seed)</code>.</p>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_seed_random_state</span><span class="p">(</span><span class="n">shuffler</span><span class="p">,</span> <span class="n">seeder</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorate a connectivity shuffler to seed it&#39;s random-state before execution.</span>

<span class="sd">    It is expected that the generator can be seeded calling `seeder(seed)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">seed_and_run_method</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">neuron_properties</span><span class="o">=</span><span class="p">[],</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reinitialize numpy random state using the value of seed among `kwargs`.</span>
<span class="sd">        doing nothing if no `seed` provided --- expecting an external initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No seed among keyword arguments&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">seeder</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">shuffler</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">neuron_properties</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">seed_and_run_method</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.add_connections" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_connections</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sparse_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function add connections at random</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code><span title="matrix">matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nc</code>
            </td>
            <td>
                  <code>Number of connections to be added</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used to selecte edges that will become reciprocal</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sparse_mode</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If sparse_mode is <code>True</code> the matrix is generated iteratively restricting to a sparse format.
If <code>False</code> adj is converted to dense and edges are added in a single step</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Digraph with nc more edges than adj</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_connections</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">nc</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sparse_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function add connections at random</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : matrix</span>
<span class="sd">        Adjacency matrix of a directed network</span>
<span class="sd">    nc : Number of connections to be added</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used to selecte edges that will become reciprocal</span>
<span class="sd">    sparse_mode: bool</span>
<span class="sd">        If sparse_mode is ``True`` the matrix is generated iteratively restricting to a sparse format.</span>
<span class="sd">        If ``False`` adj is converted to dense and edges are added in a single step</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool matrix</span>
<span class="sd">        Digraph with nc more edges than adj</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">adj</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="c1"># Add bidirectional connections</span>
    <span class="k">if</span> <span class="n">sparse_mode</span><span class="p">:</span>
        <span class="c1"># TODO: Search for more efficient way to do this</span>
        <span class="n">N</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">E</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">sum</span><span class="p">();</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># Number nodes, target edges and iteration counter</span>
        <span class="k">while</span> <span class="n">adj</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">&lt;</span> <span class="n">E</span> <span class="o">+</span><span class="n">nc</span><span class="p">:</span> <span class="c1">#target number of edges</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">&gt;</span><span class="n">max_iter</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;More than max_it iterations tried, increase number of iterations or try sparse_mode =False&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">den</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">+</span><span class="n">nc</span><span class="o">-</span><span class="n">adj</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">)</span> <span class="c1">#density of matrix added</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
            <span class="n">A</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="o">*</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">den</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">generator</span><span class="p">)</span>
            <span class="n">A</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">adj</span><span class="o">=</span><span class="n">adj</span><span class="o">+</span><span class="n">A</span><span class="p">;</span> <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">adj</span><span class="o">.</span><span class="n">eliminate_zeros</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">adj</span><span class="p">):</span> <span class="n">adj</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
        <span class="n">ul_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="o">*</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># non-diagonal indices</span>
        <span class="n">zero_ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">adj</span><span class="p">[</span><span class="n">ul_ind</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">selection</span><span class="o">=</span><span class="n">zero_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">generator</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">zero_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nc</span><span class="p">)]</span>
        <span class="n">adj</span><span class="p">[(</span><span class="n">ul_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">selection</span><span class="p">],</span><span class="n">ul_ind</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">selection</span><span class="p">])]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">adj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.add_rc_connections" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_rc_connections</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">n_rc</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function to turn a fixed amount of unidirectional connections of adj into reciprocal connections.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_rc</code>
            </td>
            <td>
                  <code>Number of reciprocal connections to be added</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used to selecte edges that will become reciprocal</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="matrix">matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Digraph with n_rc more edges than adj, all of which form reciprocal connections</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_rc_connections</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">n_rc</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to turn a fixed amount of unidirectional connections of adj into reciprocal connections.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : sparse matrix</span>
<span class="sd">        Adjacency matrix of a directed network</span>
<span class="sd">    n_rc : Number of reciprocal connections to be added</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used to selecte edges that will become reciprocal</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matrix</span>
<span class="sd">        Digraph with n_rc more edges than adj, all of which form reciprocal connections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Move this function from utils and change dependencies</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.rand_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_bidirectional_connections</span>
    <span class="c1"># Add bidirectional connections</span>
    <span class="n">generator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add_bidirectional_connections</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">n_rc</span><span class="p">,</span> <span class="n">generator</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.add_rc_connections_skeleta" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_rc_connections_skeleta</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">factors</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skeleta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_skeleta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function to add reciprocal connections at random to adj on the skeleta of maximal simplices of adj</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>factors</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Factor by which to multiply the reciprocal connections on the <code>k</code>-skeleta of adj.  If factors is an int
the same factor is used on all dimensions.  Otherwise, factors can be a dictionary with keys dimensions
and values the factor by which to multiply the number of reciprocal connections on that dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dimensions</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimensions at which to increase the number of reciprocal connections.  If <code>None</code> then all dimensions
will be used</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skeleta</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with keys f'dimension_{dim}' for dim in dimensions and values binary sparse sub-matrices of adj
on which reciprocal connections will be added.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of threads on which to parallelize the skeleta computation if not pre-computed</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used to selecte edges that will become reciprocal</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(<span title="csc_matrix">csc_matrix</span>, <span title="dict">dict</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Digraph with add reciprocal connections
If return_skeleta=True it also returns the skeleta of maximal simplices of adj in the dimensions selected</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_rc_connections_skeleta</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">factors</span><span class="p">,</span><span class="n">dimensions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skeleta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_skeleta</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to add reciprocal connections at random to adj on the skeleta of maximal simplices of adj</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : sparse matrix</span>
<span class="sd">        Adjacency matrix of a directed network</span>
<span class="sd">    factors: int or dict</span>
<span class="sd">        Factor by which to multiply the reciprocal connections on the ``k``-skeleta of adj.  If factors is an int</span>
<span class="sd">        the same factor is used on all dimensions.  Otherwise, factors can be a dictionary with keys dimensions</span>
<span class="sd">        and values the factor by which to multiply the number of reciprocal connections on that dimensions.</span>
<span class="sd">    dimensions: array</span>
<span class="sd">        The dimensions at which to increase the number of reciprocal connections.  If ``None`` then all dimensions</span>
<span class="sd">        will be used</span>
<span class="sd">    skeleta: dict</span>
<span class="sd">        Dictionary with keys f&#39;dimension_{dim}&#39; for dim in dimensions and values binary sparse sub-matrices of adj</span>
<span class="sd">        on which reciprocal connections will be added.</span>
<span class="sd">    threads: int</span>
<span class="sd">        Number of threads on which to parallelize the skeleta computation if not pre-computed</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used to selecte edges that will become reciprocal</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    csc_matrix, dict</span>
<span class="sd">        Digraph with add reciprocal connections</span>
<span class="sd">        If return_skeleta=True it also returns the skeleta of maximal simplices of adj in the dimensions selected</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">adj</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">connalysis.network.topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">rc_submatrix</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.rand_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_bidirectional_connections</span>
    <span class="c1"># Compute skeleton graphs if not precomputed</span>
    <span class="k">if</span> <span class="n">skeleta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">connalysis.network.topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_k_skeleta_graph</span>
        <span class="n">max_simplices</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># Add option for all simplices?</span>
        <span class="n">skeleta</span><span class="o">=</span><span class="n">get_k_skeleta_graph</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">max_simplices</span><span class="o">=</span><span class="n">max_simplices</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span>
    <span class="c1"># Restrict to dimensions that contain simplices</span>
    <span class="k">if</span> <span class="n">dimensions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">10</span><span class="p">:])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">skeleta</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">10</span><span class="p">:])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">skeleta</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span> <span class="n">dimensions</span><span class="p">)</span>
    <span class="c1"># Generate mapping between factors and dimensions or check the one provided</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">factors</span><span class="o">=</span><span class="p">{</span><span class="n">dim</span><span class="p">:</span><span class="n">factors</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s2">&quot;factors must be int or dictionary&quot;</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">factors</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;all dimensions must be a key in factors&quot;</span>

    <span class="c1"># Add bidirectional connections</span>
    <span class="n">generator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">rc_add</span><span class="o">=</span><span class="p">{</span><span class="n">dim</span><span class="p">:((</span><span class="n">factors</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">skeleta</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dimension_</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span><span class="o">//</span><span class="mi">2</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of reciprocal connections added per dimension&quot;</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">rc_add</span><span class="p">)</span> <span class="c1"># Remove or add verbose option</span>
    <span class="n">M</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>
        <span class="n">M</span><span class="o">+=</span><span class="n">add_bidirectional_connections</span><span class="p">(</span><span class="n">skeleta</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dimension_</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">rc_add</span><span class="p">[</span><span class="n">dim</span><span class="p">],</span> <span class="n">generator</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_skeleta</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">skeleta</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">M</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.adjusted_ER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">adjusted_ER</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function to generate an Erdos  Renyi model with adjusted bidirectional connections.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code> csc_matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="csc_matrix">csc_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Erdos Renyi shuffled control with additional reciprocal connections added at random
to match the number of reciprocal connections of the original matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.connalysis.randomization.randomization.underlying_model">underlying_model</a> :
Function which returns a digraph with the same  underlying undirected graph
and same number of reciprocal connections</p>
<p><a href="./#src.connalysis.randomization.randomization.bishuffled_model">bishuffled_model</a> :
Function which returns a digraph with shuffled reciprocal connections</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">adjusted_ER</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to generate an Erdos  Renyi model with adjusted bidirectional connections.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj :  csc_matrix</span>
<span class="sd">        Adjacency matrix of a directed network.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    csc_matrix</span>
<span class="sd">        Erdos Renyi shuffled control with additional reciprocal connections added at random</span>
<span class="sd">        to match the number of reciprocal connections of the original matrix.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [underlying_model](randomization.md#src.connalysis.randomization.randomization.underlying_model) :</span>
<span class="sd">    Function which returns a digraph with the same  underlying undirected graph</span>
<span class="sd">    and same number of reciprocal connections</span>

<span class="sd">    [bishuffled_model](randomization.md#src.connalysis.randomization.randomization.bishuffled_model) :</span>
<span class="sd">    Function which returns a digraph with shuffled reciprocal connections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">connalysis.network.topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">rc_submatrix</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.rand_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjust_bidirectional_connections</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">ER_matrix</span> <span class="o">=</span> <span class="n">ER_shuffle</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">tocsc</span><span class="p">()</span>
    <span class="n">bedges_to_add</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">()</span> <span class="o">-</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">ER_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">())</span><span class="o">//</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">bedges_to_add</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">adjust_bidirectional_connections</span><span class="p">(</span><span class="n">ER_matrix</span><span class="p">,</span> <span class="n">bedges_to_add</span><span class="p">,</span> <span class="n">generator</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Erdos-Renyi control has more reciprocal connections than original, so they are not adjusted.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ER_matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.bishuffled_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bishuffled_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function to generate a digraph with shuffled reciprocal connections</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code><span title="csc_matrix">csc_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="csc_matrix">csc_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Digraph with shuffled reciprocal connections</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.connalysis.randomization.randomization.adjusted_ER">adjusted_ER</a> :
Function to generate an Erdos  Renyi model with adjusted bidirectional connections</p>
<p><a href="./#src.connalysis.randomization.randomization.underlying_model">underlying_model</a> :
Function which returns a digraph with the same  underlying undirected graph
and same number of reciprocal connections</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bishuffled_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to generate a digraph with shuffled reciprocal connections</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : csc_matrix</span>
<span class="sd">        Adjacency matrix of a directed network.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    csc_matrix</span>
<span class="sd">        Digraph with shuffled reciprocal connections</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [adjusted_ER](randomization.md#src.connalysis.randomization.randomization.adjusted_ER) :</span>
<span class="sd">    Function to generate an Erdos  Renyi model with adjusted bidirectional connections</span>

<span class="sd">    [underlying_model](randomization.md#src.connalysis.randomization.randomization.underlying_model) :</span>
<span class="sd">    Function which returns a digraph with the same  underlying undirected graph</span>
<span class="sd">    and same number of reciprocal connections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">connalysis.network.topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">rc_submatrix</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.rand_utils</span><span class="w"> </span><span class="kn">import</span>  <span class="n">add_bidirectional_connections</span><span class="p">,</span> <span class="n">half_matrix</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">ut_bedges</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">adj</span><span class="p">))</span>
    <span class="n">target_bedges</span> <span class="o">=</span> <span class="n">ut_bedges</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">()</span>
    <span class="n">bedges1</span><span class="p">,</span> <span class="n">bedges2</span> <span class="o">=</span> <span class="n">half_matrix</span><span class="p">(</span><span class="n">ut_bedges</span><span class="p">,</span> <span class="n">generator</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add_bidirectional_connections</span><span class="p">(</span><span class="n">adj</span> <span class="o">-</span> <span class="n">bedges1</span> <span class="o">-</span> <span class="n">bedges2</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">target_bedges</span><span class="p">,</span> <span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.configuration_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">configuration_model</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function to generate the configuration control model, obtained by
shuffling the row and column of coo format independently, to create
new coo matrix, then removing any multiple edges and loops.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code><span title="coo">coo</span> - <span title="matrix">matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>csr matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration model control of adj</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.connalysis.randomization.randomization.run_SBM">run_SBM</a> :
Function which runs the stochastic block model</p>
<p><a href="./#src.connalysis.randomization.randomization.run_DD2">run_DD2</a> :
Function which runs the 2nd distance dependent model</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configuration_model</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to generate the configuration control model, obtained by</span>
<span class="sd">    shuffling the row and column of coo format independently, to create</span>
<span class="sd">    new coo matrix, then removing any multiple edges and loops.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : coo-matrix</span>
<span class="sd">        Adjacency matrix of a directed network.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    csr matrix</span>
<span class="sd">        Configuration model control of adj</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [run_SBM](randomization.md#src.connalysis.randomization.randomization.run_SBM) :</span>
<span class="sd">    Function which runs the stochastic block model</span>

<span class="sd">    [run_DD2](randomization.md#src.connalysis.randomization.randomization.run_DD2) :</span>
<span class="sd">    Function which runs the 2nd distance dependent model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">adj</span><span class="o">=</span><span class="n">M</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">tocoo</span><span class="p">()</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">row</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">col</span>
    <span class="n">generator</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
    <span class="n">generator</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
    <span class="n">CM_matrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">),(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">)),</span><span class="n">shape</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>
    <span class="n">CM_matrix</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">CM_matrix</span><span class="o">.</span><span class="n">eliminate_zeros</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">CM_matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_DD2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_DD2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a random digraph using the 2nd-order probability model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficient of probability function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Absolute value of power of exponent in probability function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xyz</code>
            </td>
            <td>
                  <code>(n,3)-numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Co-ordinates of vertices in <span class="arithmatex">\(\mathbb{R}^3\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="../modelling/#src.connalysis.modelling.modelling.conn_prob_2nd_order_model">conn_prob_2nd_order_model</a> :
The modelling function from which the parameters <code>a</code> and <code>b</code>can be obtained.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_DD2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a random digraph using the 2nd-order probability model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of vertices</span>
<span class="sd">    a : float</span>
<span class="sd">        Coefficient of probability function</span>
<span class="sd">    b : float</span>
<span class="sd">        Absolute value of power of exponent in probability function</span>
<span class="sd">    xyz : (n,3)-numpy array of floats</span>
<span class="sd">        Co-ordinates of vertices in $\mathbb{R}^3$</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [conn_prob_2nd_order_model](modelling.md#src.connalysis.modelling.modelling.conn_prob_2nd_order_model) :</span>
<span class="sd">    The modelling function from which the parameters ``a`` and ``b``can be obtained.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">threads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">threads</span><span class="p">,</span><span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_dict_to_coo</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_DD2_block" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_DD2_block</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a random digraph using a combination of the stochastic block model
   and the 2nd order distance dependent model. Such that the probability of an edge
   is given by the distance dependent equation, but the parameters of that equation
   vary depending on the block of the source of the edge and block of the target.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probs</code>
            </td>
            <td>
                  <code>numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape=(m,m,2) where m is the number of blocks. For source vertex i and target vertex j
probs[i][j][0] is the coefficient of the distance dependent equation (value a) and
probs[i][j][0] is the absolute value of power of exponent in the distance dependent equation (value b)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blocks</code>
            </td>
            <td>
                  <code>numpy array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape=(n,). The i'th entry is which block vertex i belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xyz</code>
            </td>
            <td>
                  <code>(n,3)-numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Co-ordinates of vertices in <span class="arithmatex">\(\mathbb{R}^3\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If blocks contains non-integers</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.connalysis.randomization.randomization.run_DD2">run_DD2</a> :
Function which runs the 2nd distance dependent model</p>
<p><a href="./#src.connalysis.randomization.randomization.run_SBM">run_SBM</a> :
Function which runs the stochastic block model</p>
<p><a href="./#src.connalysis.randomization.randomization.run_DD2_block_pre">run_DD2_block_pre</a> :
Similar function that only accounts for the block of the source vertex</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_DD2_block</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a random digraph using a combination of the stochastic block model</span>
<span class="sd">       and the 2nd order distance dependent model. Such that the probability of an edge</span>
<span class="sd">       is given by the distance dependent equation, but the parameters of that equation</span>
<span class="sd">       vary depending on the block of the source of the edge and block of the target.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of vertices</span>
<span class="sd">    probs : numpy array of floats</span>
<span class="sd">        shape=(m,m,2) where m is the number of blocks. For source vertex i and target vertex j</span>
<span class="sd">        probs[i][j][0] is the coefficient of the distance dependent equation (value a) and</span>
<span class="sd">        probs[i][j][0] is the absolute value of power of exponent in the distance dependent equation (value b)</span>
<span class="sd">    blocks : numpy array of ints</span>
<span class="sd">        shape=(n,). The i&#39;th entry is which block vertex i belongs to.</span>
<span class="sd">    xyz : (n,3)-numpy array of floats</span>
<span class="sd">        Co-ordinates of vertices in $\mathbb{R}^3$</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>


<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    TypeError</span>
<span class="sd">        If blocks contains non-integers</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [run_DD2](randomization.md#src.connalysis.randomization.randomization.run_DD2) :</span>
<span class="sd">    Function which runs the 2nd distance dependent model</span>

<span class="sd">    [run_SBM](randomization.md#src.connalysis.randomization.randomization.run_SBM) :</span>
<span class="sd">    Function which runs the stochastic block model</span>

<span class="sd">    [run_DD2_block_pre](randomization.md#src.connalysis.randomization.randomization.run_DD2_block_pre) :</span>
<span class="sd">    Similar function that only accounts for the block of the source vertex</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD2_block</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD2_block</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_dict_to_coo</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_DD2_block_pre" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_DD2_block_pre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a random digraph using a combination of the stochastic block model
   and the 2nd order distance dependent model. Such that the probability of an edge
   is given by the distance dependent equation, but the parameters of that equation
   vary depending on the block of the source of the edge.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probs</code>
            </td>
            <td>
                  <code>numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape=(m,2) where m is the number of blocks.
probs[i][0] is the coefficient of the distance dependent equation (value a) for source vertex i and
probs[i][0] is the absolute value of power of exponent in the distance dependent equation (value b)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blocks</code>
            </td>
            <td>
                  <code>numpy array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape=(n,). The i'th entry is which block vertex i belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xyz</code>
            </td>
            <td>
                  <code>(n,3)-numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Co-ordinates of vertices in <span class="arithmatex">\(\mathbb{R}^3\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If blocks contains non-integers</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.connalysis.randomization.randomization.run_SBM">run_SBM</a>:
Function which runs the stochastic block model</p>
<p><a href="./#src.connalysis.randomization.randomization.run_DD2">run_DD2</a> :
Function which runs the 2nd distance dependent model</p>
<p><a href="./#src.connalysis.randomization.randomization.run_DD2_block">run_DD2_block</a> :
Similar function that also accounts for the block of the target vertex</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_DD2_block_pre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a random digraph using a combination of the stochastic block model</span>
<span class="sd">       and the 2nd order distance dependent model. Such that the probability of an edge</span>
<span class="sd">       is given by the distance dependent equation, but the parameters of that equation</span>
<span class="sd">       vary depending on the block of the source of the edge.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of vertices</span>
<span class="sd">    probs : numpy array of floats</span>
<span class="sd">        shape=(m,2) where m is the number of blocks.</span>
<span class="sd">        probs[i][0] is the coefficient of the distance dependent equation (value a) for source vertex i and</span>
<span class="sd">        probs[i][0] is the absolute value of power of exponent in the distance dependent equation (value b)</span>
<span class="sd">    blocks : numpy array of ints</span>
<span class="sd">        shape=(n,). The i&#39;th entry is which block vertex i belongs to.</span>
<span class="sd">    xyz : (n,3)-numpy array of floats</span>
<span class="sd">        Co-ordinates of vertices in $\mathbb{R}^3$</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>


<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    TypeError</span>
<span class="sd">        If blocks contains non-integers</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [run_SBM](randomization.md#src.connalysis.randomization.randomization.run_SBM):</span>
<span class="sd">    Function which runs the stochastic block model</span>

<span class="sd">    [run_DD2](randomization.md#src.connalysis.randomization.randomization.run_DD2) :</span>
<span class="sd">    Function which runs the 2nd distance dependent model</span>

<span class="sd">    [run_DD2_block](randomization.md#src.connalysis.randomization.randomization.run_DD2_block) :</span>
<span class="sd">    Similar function that also accounts for the block of the target vertex</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD2_block_pre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD2_block_pre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_dict_to_coo</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_DD2_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_DD2_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">node_properties</span><span class="p">,</span> <span class="n">model_params_dd2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coord_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">return_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">config_dict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Wrapper for fitting a model and generating a random control graph based on 2nd order distance dependence model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>sparse matrix or 2d-array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix.
If model_params_dd2 have already been computed, one can pass an empty matrix of the right size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node_properties</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with information on the vertices of adj.
It must have columns corresponding to the names of the coord_names to be used for distance computation (Default: ['x', 'y', 'z']).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params_dd2</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional input of pre-computed model parameters as data frame with rows corresponding to seeds of model estimation
(single row if subsampling is not used) and columns 'exp_model_scale' and 'exp_model_exponent' for the model parameters.
See modelling.conn_prob_2nd_order_model for details.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coord_names</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the coordinates (corresponding to columns in neuron properties table) based on which to compute Euclidean distance.
Default: ['x', 'y', 'z']</p>
              </div>
            </td>
            <td>
                  <code>[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used.</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_params</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns model_params_dd2 in addition to the generated control.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with 2nd order model building settings.
See modelling.conn_prob_2nd_order_model for details.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="coo_matrix">coo_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="model_params_dd2">model_params_dd2</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame with model parameters (optional; if return_params is True)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="../modelling/#src.connalysis.modelling.modelling.conn_prob_2nd_order_model">conn_prob_2nd_order_model</a> :
The modelling function from which model_params_dd2 can be obtained.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_DD2_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">node_properties</span><span class="p">,</span>
                  <span class="n">model_params_dd2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1">#an analysis that could be loaded from the pipeline</span>
                  <span class="n">coord_names</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
                  <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">return_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">config_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper for fitting a model and generating a random control graph based on 2nd order distance dependence model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : sparse matrix or 2d-array</span>
<span class="sd">        Adjacency matrix.</span>
<span class="sd">        If model_params_dd2 have already been computed, one can pass an empty matrix of the right size.</span>
<span class="sd">    node_properties : pandas.DataFrame</span>
<span class="sd">        DataFrame with information on the vertices of adj.</span>
<span class="sd">        It must have columns corresponding to the names of the coord_names to be used for distance computation (Default: [&#39;x&#39;, &#39;y&#39;, &#39;z&#39;]).</span>
<span class="sd">    model_params_dd2 : pandas.DataFrame</span>
<span class="sd">        Optional input of pre-computed model parameters as data frame with rows corresponding to seeds of model estimation</span>
<span class="sd">        (single row if subsampling is not used) and columns &#39;exp_model_scale&#39; and &#39;exp_model_exponent&#39; for the model parameters.</span>
<span class="sd">        See modelling.conn_prob_2nd_order_model for details.</span>
<span class="sd">    coord_names : list</span>
<span class="sd">        Names of the coordinates (corresponding to columns in neuron properties table) based on which to compute Euclidean distance.</span>
<span class="sd">        Default: [&#39;x&#39;, &#39;y&#39;, &#39;z&#39;]</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used.</span>
<span class="sd">    return_params : bool</span>
<span class="sd">        If True, returns model_params_dd2 in addition to the generated control.</span>
<span class="sd">    config_dict : dict</span>
<span class="sd">        Dictionary with 2nd order model building settings.</span>
<span class="sd">        See modelling.conn_prob_2nd_order_model for details.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo_matrix</span>
<span class="sd">        Matrix of the generated control</span>
<span class="sd">    model_params_dd2</span>
<span class="sd">        pandas.DataFrame with model parameters (optional; if return_params is True)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [conn_prob_2nd_order_model](modelling.md#src.connalysis.modelling.modelling.conn_prob_2nd_order_model) :</span>
<span class="sd">    The modelling function from which model_params_dd2 can be obtained.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">model_params_dd2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.import</span> <span class="n">modelling</span>
        <span class="c1">#TODO:  What to do if coord_names are also given in configdict and do not match coord_names?</span>
        <span class="n">config_dict</span><span class="p">[</span><span class="s2">&quot;coord_names&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">coord_names</span>
        <span class="n">model_params_dd2</span> <span class="o">=</span> <span class="n">modelling</span><span class="o">.</span><span class="n">conn_prob_2nd_order_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">node_properties</span><span class="p">,</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fit parameters are used directly but should be checked by hand if the proper fit is obtained!&quot;</span><span class="p">)</span>

    <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Run DD2 model with parameters: </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">model_params_dd2</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">model_params_dd2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;exp_model_scale&#39;</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">model_params_dd2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;exp_model_exponent&#39;</span><span class="p">]</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">node_properties</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">coord_names</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="c1">#Make and assert that checks these columns exist!</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_names</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span> <span class="c1">#Extend by zeros if lower dimensional data was used to compute distance</span>
        <span class="n">xyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">xyz</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="o">-</span><span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))])</span>
    <span class="n">C</span><span class="o">=</span><span class="n">gm</span><span class="o">.</span><span class="n">DD2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">threads</span><span class="p">)</span>
    <span class="n">i</span><span class="o">=</span><span class="n">C</span><span class="p">[</span><span class="s1">&#39;row&#39;</span><span class="p">]</span>
    <span class="n">j</span><span class="o">=</span><span class="n">C</span><span class="p">[</span><span class="s1">&#39;col&#39;</span><span class="p">]</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_params</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)),</span> <span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">]),</span> <span class="n">model_params_dd2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)),</span> <span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_DD3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_DD3</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">depths</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a random digraph using the 2nd-order probability model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficient of probability function for negative depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Absolute value of power of exponent in probability function for negative depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a2</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficient of probability function for positive depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b2</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Absolute value of power of exponent in probability function for positive depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xyz</code>
            </td>
            <td>
                  <code>(n,3)-numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Co-ordinates of vertices in <span class="arithmatex">\(\mathbb{R}^3\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="../modelling/#src.connalysis.modelling.modelling.conn_prob_3rd_order_model">conn_prob_3rd_order_model</a> :
The modelling function from which the parameters <code>a1/a2</code> and <code>b1/b2</code>can be obtained.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_DD3</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">depths</span><span class="p">,</span><span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a random digraph using the 2nd-order probability model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of vertices</span>
<span class="sd">    a1 : float</span>
<span class="sd">        Coefficient of probability function for negative depth</span>
<span class="sd">    b1 : float</span>
<span class="sd">        Absolute value of power of exponent in probability function for negative depth</span>
<span class="sd">    a2 : float</span>
<span class="sd">        Coefficient of probability function for positive depth</span>
<span class="sd">    b2 : float</span>
<span class="sd">        Absolute value of power of exponent in probability function for positive depth</span>
<span class="sd">    xyz : (n,3)-numpy array of floats</span>
<span class="sd">        Co-ordinates of vertices in $\mathbb{R}^3$</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [conn_prob_3rd_order_model](modelling.md#src.connalysis.modelling.modelling.conn_prob_3rd_order_model) :</span>
<span class="sd">    The modelling function from which the parameters ``a1/a2`` and ``b1/b2``can be obtained.</span>



<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD3</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">depths</span><span class="p">,</span><span class="n">threads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">DD3</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">depths</span><span class="p">,</span><span class="n">threads</span><span class="p">,</span><span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_dict_to_coo</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_ER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_ER</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates an Erdos Renyi digraph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Edge probablity, must satisfy <span class="arithmatex">\(0 \le p \le 1\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Setting n=3 and p=1 gives the complete digraph on 3 vertices:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">connalysis</span><span class="o">.</span><span class="n">randomization</span><span class="o">.</span><span class="n">run_ER</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{&#39;row&#39;: [0, 0, 1, 1, 2, 2], &#39;col&#39;: [1, 2, 0, 2, 0, 1]}</span>
</code></pre></div>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If p is not between 0 and 1</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_ER</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an Erdos Renyi digraph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of vertices</span>
<span class="sd">    p : float</span>
<span class="sd">        Edge probablity, must satisfy $0 \\le p \\le 1$</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Setting n=3 and p=1 gives the complete digraph on 3 vertices:</span>
<span class="sd">    &gt;&gt;&gt; connalysis.randomization.run_ER(3,1)</span>
<span class="sd">    {&#39;row&#39;: [0, 0, 1, 1, 2, 2], &#39;col&#39;: [1, 2, 0, 2, 0, 1]}</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If p is not between 0 and 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;p must be between 0 and 1&quot;</span>
    <span class="k">if</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">ER</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">threads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">ER</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">threads</span><span class="p">,</span><span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_dict_to_coo</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.run_SBM" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_SBM</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a random digraph using the stochastic block model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probs</code>
            </td>
            <td>
                  <code>numpy array of floats</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape=(m,m) where m is the number of blocks.
probs[i][j] is probability of an edge between block i and block j</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blocks</code>
            </td>
            <td>
                  <code>numpy array of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape=(n,). The i'th entry gives to which block vertex i belongs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel threads to be used</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>pair of ints</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used, if none is provided a seed is randomly selected</p>
              </div>
            </td>
            <td>
                  <code>(None, None)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>coo matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of the generated control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>To create an SBM digraph on 4 vertices where the even to
odd, or odd to even, vertices connect with high probablity (p=0.9)
and the even to evens or odd to odds connect with low probability (p=0.1):</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">connalysis</span><span class="o">.</span><span class="n">randomization</span><span class="o">.</span><span class="n">run_SBM</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.9</span><span class="p">],[</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">{&#39;row&#39;: [0, 0, 1, 1, 1, 2, 2, 3, 3], &#39;col&#39;: [1, 3, 0, 2, 3, 1, 3, 0, 2]</span>
</code></pre></div>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If blocks contains non-integers</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="references" open>
  <summary>References</summary>
  <p>[1] P.W. Holland, K. Laskey, S. Leinhardt,
<a href="https://www.sciencedirect.com/science/article/pii/0378873383900217">"Stochastic Blockmodels: First Steps"</a>,
Soc Networks, 5-2, pp. 109-137, 1982</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_SBM</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a random digraph using the stochastic block model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of vertices</span>
<span class="sd">    probs : numpy array of floats</span>
<span class="sd">        shape=(m,m) where m is the number of blocks.</span>
<span class="sd">        probs[i][j] is probability of an edge between block i and block j</span>
<span class="sd">    blocks : numpy array of ints</span>
<span class="sd">        shape=(n,). The i&#39;th entry gives to which block vertex i belongs.</span>
<span class="sd">    threads : int</span>
<span class="sd">        Number of parallel threads to be used</span>
<span class="sd">    seed : pair of ints</span>
<span class="sd">        Random seed to be used, if none is provided a seed is randomly selected</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coo matrix</span>
<span class="sd">        Matrix of the generated control</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    To create an SBM digraph on 4 vertices where the even to</span>
<span class="sd">    odd, or odd to even, vertices connect with high probablity (p=0.9)</span>
<span class="sd">    and the even to evens or odd to odds connect with low probability (p=0.1):</span>
<span class="sd">    &gt;&gt;&gt; connalysis.randomization.run_SBM(4,np.array([[0.1,0.9],[0.9,0.1]]),np.array([0,1,0,1]))</span>
<span class="sd">    {&#39;row&#39;: [0, 0, 1, 1, 1, 2, 2, 3, 3], &#39;col&#39;: [1, 3, 0, 2, 3, 1, 3, 0, 2]</span>


<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    TypeError</span>
<span class="sd">        If blocks contains non-integers</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    [1] P.W. Holland, K. Laskey, S. Leinhardt,</span>
<span class="sd">    [&quot;Stochastic Blockmodels: First Steps&quot;](https://www.sciencedirect.com/science/article/pii/0378873383900217),</span>
<span class="sd">    Soc Networks, 5-2, pp. 109-137, 1982</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">SBM</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">threads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">SBM</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">seed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_dict_to_coo</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.randomization.randomization.underlying_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">underlying_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Function to generate a digraph with the same  underlying undirected graph as adj
    and the same number of reciprocal connections</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code><span title="csc_matrix">csc_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of a directed network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed to be used</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="csc_matrix">csc_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Digraph with the same  underlying undirected graph as adj and the same number of reciprocal connections</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.connalysis.randomization.randomization.adjusted_ER">adjusted_ER</a> :
Function to generate an Erdos  Renyi model with adjusted bidirectional connections</p>
<p><a href="./#src.connalysis.randomization.randomization.bishuffled_model">bishuffled_model</a> :
Function which returns a digraph with shuffled reciprocal connections</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/randomization/randomization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">underlying_model</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to generate a digraph with the same  underlying undirected graph as adj</span>
<span class="sd">        and the same number of reciprocal connections</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : csc_matrix</span>
<span class="sd">        Adjacency matrix of a directed network.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed to be used</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    csc_matrix</span>
<span class="sd">        Digraph with the same  underlying undirected graph as adj and the same number of reciprocal connections</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [adjusted_ER](randomization.md#src.connalysis.randomization.randomization.adjusted_ER) :</span>
<span class="sd">    Function to generate an Erdos  Renyi model with adjusted bidirectional connections</span>

<span class="sd">    [bishuffled_model](randomization.md#src.connalysis.randomization.randomization.bishuffled_model) :</span>
<span class="sd">    Function which returns a digraph with shuffled reciprocal connections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">connalysis.network.topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">rc_submatrix</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.rand_utils</span><span class="w"> </span><span class="kn">import</span>  <span class="n">add_bidirectional_connections</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">target_bedges</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ut_matrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">adj</span> <span class="o">+</span> <span class="n">adj</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add_bidirectional_connections</span><span class="p">(</span><span class="n">ut_matrix</span><span class="p">,</span> <span class="n">target_bedges</span><span class="p">,</span> <span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>