
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../network_topology/">
      
      
        <link rel="next" href="../network_local/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Classic - connalysis</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#these-functions-are-classic-graph-theoretic-metrics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="connalysis" class="md-header__button md-logo" aria-label="connalysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            connalysis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Classic
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openbraininstitute/connectome-analysis.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="connalysis" class="md-nav__button md-logo" aria-label="connalysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    connalysis
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openbraininstitute/connectome-analysis.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modelling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../randomization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Randomization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_topology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Classic
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Classic
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#these-functions-are-classic-graph-theoretic-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      These functions are classic graph theoretic metrics.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic" class="md-nav__link">
    <span class="md-ellipsis">
      classic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.ccc" class="md-nav__link">
    <span class="md-ellipsis">
      ccc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.closeness_connected_components" class="md-nav__link">
    <span class="md-ellipsis">
      closeness_connected_components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.connected_components" class="md-nav__link">
    <span class="md-ellipsis">
      connected_components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.connection_probability_within" class="md-nav__link">
    <span class="md-ellipsis">
      connection_probability_within
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.core_number" class="md-nav__link">
    <span class="md-ellipsis">
      core_number
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.density" class="md-nav__link">
    <span class="md-ellipsis">
      density
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.efficient_rich_club_curve" class="md-nav__link">
    <span class="md-ellipsis">
      efficient_rich_club_curve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.get_pairs_within" class="md-nav__link">
    <span class="md-ellipsis">
      get_pairs_within
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.largest_strongly_connected_component" class="md-nav__link">
    <span class="md-ellipsis">
      largest_strongly_connected_component
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.np_to_nx" class="md-nav__link">
    <span class="md-ellipsis">
      np_to_nx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.nx_to_np" class="md-nav__link">
    <span class="md-ellipsis">
      nx_to_np
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.rich_club_curve" class="md-nav__link">
    <span class="md-ellipsis">
      rich_club_curve
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_local/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stats
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#these-functions-are-classic-graph-theoretic-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      These functions are classic graph theoretic metrics.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic" class="md-nav__link">
    <span class="md-ellipsis">
      classic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.ccc" class="md-nav__link">
    <span class="md-ellipsis">
      ccc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.closeness_connected_components" class="md-nav__link">
    <span class="md-ellipsis">
      closeness_connected_components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.connected_components" class="md-nav__link">
    <span class="md-ellipsis">
      connected_components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.connection_probability_within" class="md-nav__link">
    <span class="md-ellipsis">
      connection_probability_within
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.core_number" class="md-nav__link">
    <span class="md-ellipsis">
      core_number
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.density" class="md-nav__link">
    <span class="md-ellipsis">
      density
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.efficient_rich_club_curve" class="md-nav__link">
    <span class="md-ellipsis">
      efficient_rich_club_curve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.get_pairs_within" class="md-nav__link">
    <span class="md-ellipsis">
      get_pairs_within
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.largest_strongly_connected_component" class="md-nav__link">
    <span class="md-ellipsis">
      largest_strongly_connected_component
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.np_to_nx" class="md-nav__link">
    <span class="md-ellipsis">
      np_to_nx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.nx_to_np" class="md-nav__link">
    <span class="md-ellipsis">
      nx_to_np
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.connalysis.network.classic.rich_club_curve" class="md-nav__link">
    <span class="md-ellipsis">
      rich_club_curve
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Classic</h1>

<h2 id="these-functions-are-classic-graph-theoretic-metrics">These functions are classic graph theoretic metrics.</h2>


<div class="doc doc-object doc-module">



<a id="src.connalysis.network.classic"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.ccc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ccc</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the classical clustering coefficient of a directed graph</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the adjaceny matrix of an unweighted graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index is the node index in <code>matrix</code> and the value is the clustering coefficient of the node. </p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="references" open>
  <summary>References</summary>
  <p>The formula is taken from the following paper.</p>
<p>[1] G. Fagiolo, "Clustering in complex directed networks", 2006;
        <a href="">DOI: 10.1103/PhysRevE.76.026107</a>.</p>
<p>[2] Conceição, Pedro, et al. "An application of neighbourhoods in digraphs to the classification of binary dynamics.", 2022
        <a href="">DOI: 10.1162/netn_a_00228</a>.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ccc</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the classical clustering coefficient of a directed graph</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    matrix : numpy array</span>
<span class="sd">        the adjaceny matrix of an unweighted graph</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Series</span>
<span class="sd">        The index is the node index in ``matrix`` and the value is the clustering coefficient of the node. </span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    The formula is taken from the following paper.</span>

<span class="sd">    [1] G. Fagiolo, &quot;Clustering in complex directed networks&quot;, 2006;</span>
<span class="sd">            [DOI: 10.1103/PhysRevE.76.026107]().</span>

<span class="sd">    [2] Conceição, Pedro, et al. &quot;An application of neighbourhoods in digraphs to the classification of binary dynamics.&quot;, 2022</span>
<span class="sd">            [DOI: 10.1162/netn_a_00228](). </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We only analyze the udnerlying connectivity not the weights</span>
    <span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Numerator </span>
    <span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
        <span class="n">dense_matrix</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">+</span> <span class="n">matrix</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">dense_matrix</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">matrix</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="c1"># Denominator</span>
    <span class="n">deg</span> <span class="o">=</span> <span class="n">node_degree</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> 
    <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">deg</span><span class="o">*</span><span class="p">(</span><span class="n">deg</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.closeness_connected_components" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">closeness_connected_components</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_sum</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute the closeness of each connected component of more than 1 vertex</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code><span title="array_like">array_like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, will be computed using strongly connected components and directed closeness.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_sum</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, only one list will be returned, by summing over all the connected components.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="array_like">array_like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single array( if <code>return_sum=True</code>) or a list of arrays of shape <code>n</code>, containting closeness of vertices in that component, or 0 if the vertex is not in the component. Closeness cannot be zero otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">closeness_connected_components</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_sum</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the closeness of each connected component of more than 1 vertex</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : array_like</span>
<span class="sd">        Adjacency matrix of the graph</span>
<span class="sd">    directed : bool</span>
<span class="sd">        If `True`, will be computed using strongly connected components and directed closeness.</span>
<span class="sd">    return_sum : bool</span>
<span class="sd">        If `True`, only one list will be returned, by summing over all the connected components.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array_like</span>
<span class="sd">        A single array( if `return_sum=True`) or a list of arrays of shape `n`, containting closeness of vertices in that component, or 0 if the vertex is not in the component. Closeness cannot be zero otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sknetwork.ranking</span><span class="w"> </span><span class="kn">import</span> <span class="n">Closeness</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.csgraph</span><span class="w"> </span><span class="kn">import</span> <span class="n">connected_components</span>

    <span class="n">matrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">directed</span><span class="p">:</span>
        <span class="n">n_comp</span><span class="p">,</span> <span class="n">comp</span> <span class="o">=</span> <span class="n">connected_components</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="s2">&quot;strong&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_comp</span><span class="p">,</span> <span class="n">comp</span> <span class="o">=</span> <span class="n">connected_components</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">+</span> <span class="n">matrix</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># we need to make the matrix symmetric</span>

    <span class="n">closeness</span> <span class="o">=</span> <span class="n">Closeness</span><span class="p">()</span>  <span class="c1"># if matrix is not symmetric automatically use directed</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">all_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">comp</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sub_mat</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">sub_mat</span><span class="o">.</span><span class="n">getnnz</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">closeness</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">sub_mat</span><span class="p">)</span>
            <span class="n">all_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_sum</span><span class="p">:</span>
        <span class="n">all_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">all_c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">all_c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">all_c</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.connected_components" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connected_components</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="s1">&#39;weak&#39;</span><span class="p">,</span> <span class="n">return_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns a list of the size of the connected components of the graph</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>array_like or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, will be compute connected components of the directed graph</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>connection</code>
            </td>
            <td>
                  <code>str {&#39;weak&#39;, &#39;strong&#39;}</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>weak</code>, it will compute the connected components of the underlying undirected graph. 
If <code>strong</code>, it will compute strongly connected components of the directed graph.</p>
              </div>
            </td>
            <td>
                  <code>&#39;weak&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_labels</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, will return the labels of the connected components</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="array_like">array_like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of the size of the connected components of the graph. 
If return_labels == True, it also returns the list of labels of the connected components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connected_components</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="s1">&#39;weak&#39;</span><span class="p">,</span> <span class="n">return_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of the size of the connected components of the graph</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adj : array_like or sparse matrix</span>
<span class="sd">        Adjacency matrix of the graph</span>
<span class="sd">    directed : bool</span>
<span class="sd">        If `True`, will be compute connected components of the directed graph</span>
<span class="sd">    connection : str {&#39;weak&#39;, &#39;strong&#39;}</span>
<span class="sd">        If `weak`, it will compute the connected components of the underlying undirected graph. </span>
<span class="sd">        If `strong`, it will compute strongly connected components of the directed graph.</span>
<span class="sd">    return_labels : bool</span>
<span class="sd">        If `True`, will return the labels of the connected components</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array_like</span>
<span class="sd">        A list of the size of the connected components of the graph. </span>
<span class="sd">        If return_labels == True, it also returns the list of labels of the connected components.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matrix</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>

    <span class="n">comps</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">csgraph</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">matrix</span> <span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">,</span> 
                                          <span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">,</span> <span class="n">return_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">comps_size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_labels</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">comps_size</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">comps_size</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.connection_probability_within" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connection_probability_within</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">max_dist</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;directed&#39;</span><span class="p">,</span> <span class="n">skip_symmetry_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the average density of submatrices of nodes within distance <code>max_dist</code> of each node in <code>m</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>array or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code><span title="DataFrame">DataFrame</span> or <span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with the coordinates of the nodes if m is square and has the same pre and post nodes. 
If a tuple is passed, it should contain two DataFrames, one for the source nodes and one for the target nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns of the DataFrame containing the coordinates of the nodes.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;x&#39;, &#39;y&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum distance between nodes to be considered connected.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type</code>
            </td>
            <td>
                  <code>str {&#39;directed&#39;, &#39;undirected&#39;, &#39;reciprocal&#39;}</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the graph considered for the computation.
If 'directed', the density as a directed graph is computed.
If 'undirected', the density of the underlying undirected graph is computed. Only possible if the matrix is square.
If 'reciprocal', the density of the underlying reciprocal graph is computed. Only possible if the matrix is square.</p>
              </div>
            </td>
            <td>
                  <code>&#39;directed&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_symmetry_check</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, it will skip the check for symmetry of the matrix.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The average density of the submatrices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connection_probability_within</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">max_dist</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;directed&#39;</span><span class="p">,</span> <span class="n">skip_symmetry_check</span><span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the average density of submatrices of nodes within distance `max_dist` of each node in `m`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : array or sparse matrix</span>
<span class="sd">            Adjacency matrix of the graph</span>
<span class="sd">        v : DataFrame or tuple</span>
<span class="sd">            DataFrame with the coordinates of the nodes if m is square and has the same pre and post nodes. </span>
<span class="sd">            If a tuple is passed, it should contain two DataFrames, one for the source nodes and one for the target nodes.</span>
<span class="sd">        cols : list</span>
<span class="sd">            Columns of the DataFrame containing the coordinates of the nodes.</span>
<span class="sd">        max_dist : float</span>
<span class="sd">            Maximum distance between nodes to be considered connected.        </span>
<span class="sd">        type : str {&#39;directed&#39;, &#39;undirected&#39;, &#39;reciprocal&#39;}</span>
<span class="sd">            The type of the graph considered for the computation.</span>
<span class="sd">            If &#39;directed&#39;, the density as a directed graph is computed.</span>
<span class="sd">            If &#39;undirected&#39;, the density of the underlying undirected graph is computed. Only possible if the matrix is square.</span>
<span class="sd">            If &#39;reciprocal&#39;, the density of the underlying reciprocal graph is computed. Only possible if the matrix is square.</span>
<span class="sd">        skip_symmetry_check : bool</span>
<span class="sd">            If `True`, it will skip the check for symmetry of the matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The average density of the submatrices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get coordinates of nodes and their nearest neighbors</span>
    <span class="n">pairs_mat</span><span class="o">=</span><span class="n">get_pairs_within</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="n">max_dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pairs_mat</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="o">==</span><span class="s1">&#39;reciprocal&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;The matrix must be square to compute the reciprocal connectivity&quot;</span>
            <span class="n">m</span><span class="o">=</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">tocsc</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="o">==</span><span class="s1">&#39;undirected&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;The matrix must be square to compute the undirected connectivity&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_symmetry_check</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">!=</span><span class="n">m</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">nnz</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The graph is directed. Taking the underlying undirected graph&quot;</span><span class="p">)</span>
                    <span class="n">m</span><span class="o">=</span><span class="n">underlying_undirected_matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">m</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="o">==</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span>
            <span class="n">m</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Type must be &#39;directed&#39;, &#39;undirected&#39; or &#39;reciprocal&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="n">pairs_mat</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.core_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">core_number</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the core number for each node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>array_like or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, will be compute connected components of the directed graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>connection</code>
            </td>
            <td>
                  <code>str {&#39;weak&#39;, &#39;strong&#39;}</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>weak</code>, it will compute the connected components of the underlying undirected graph. 
If <code>strong</code>, it will compute strongly connected components of the directed graph.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_labels</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, will return the labels of the connected components</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys the indices of the nodes of adj and values their corresponding core number.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The k-core of a graph is the maximal subgraph that contains nodes of degree k or more in the induced subgraph.
The core number of a node is the largest value k of a k-core containing that node.
For directed graphs the total node degree is use, i.e., the sum of in-degree + out-degree.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">core_number</span><span class="p">(</span><span class="n">adj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the core number for each node.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        adj : array_like or sparse matrix</span>
<span class="sd">            Adjacency matrix of the graph</span>
<span class="sd">        directed : bool</span>
<span class="sd">            If `True`, will be compute connected components of the directed graph</span>
<span class="sd">        connection : str {&#39;weak&#39;, &#39;strong&#39;}</span>
<span class="sd">            If `weak`, it will compute the connected components of the underlying undirected graph. </span>
<span class="sd">            If `strong`, it will compute strongly connected components of the directed graph.</span>
<span class="sd">        return_labels : bool</span>
<span class="sd">            If `True`, will return the labels of the connected components</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A dictionary with keys the indices of the nodes of adj and values their corresponding core number.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The k-core of a graph is the maximal subgraph that contains nodes of degree k or more in the induced subgraph.</span>
<span class="sd">        The core number of a node is the largest value k of a k-core containing that node.</span>
<span class="sd">        For directed graphs the total node degree is use, i.e., the sum of in-degree + out-degree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Implement directed (k,l) core and k-core of underlying undirected graph (very similar to this)</span>
    <span class="c1"># TODO: Filtered simplex counts with different weights on vertices (coreness, intersection)</span>
    <span class="c1">#  or on edges (strength of connection).    </span>
    <span class="n">adj</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_scipy_sparse_array</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="c1"># Very inefficient (returns a dictionary!). TODO: Look for different implementation</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">core_number</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.density" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">density</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;directed&#39;</span><span class="p">,</span> <span class="n">skip_symmetry_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the density of a matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adj</code>
            </td>
            <td>
                  <code>array_like or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type</code>
            </td>
            <td>
                  <code>str {&#39;directed&#39;, &#39;undirected&#39;, &#39;reciprocal&#39;}</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the graph considered for the computation.
If 'directed', the density as a directed graph is computed.
If 'undirected', the density of the underlying undirected graph is computed.
If 'reciprocal', the density of the underlying reciprocal graph is computed.</p>
              </div>
            </td>
            <td>
                  <code>&#39;directed&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_symmetry_check</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, it will skip the check for symmetry of the matrix.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The density of the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">density</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;directed&quot;</span><span class="p">,</span> <span class="n">skip_symmetry_check</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the density of a matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        adj : array_like or sparse matrix</span>
<span class="sd">            Adjacency matrix of the graph</span>
<span class="sd">        type : str {&#39;directed&#39;, &#39;undirected&#39;, &#39;reciprocal&#39;}</span>
<span class="sd">            The type of the graph considered for the computation.</span>
<span class="sd">            If &#39;directed&#39;, the density as a directed graph is computed.</span>
<span class="sd">            If &#39;undirected&#39;, the density of the underlying undirected graph is computed.</span>
<span class="sd">            If &#39;reciprocal&#39;, the density of the underlying reciprocal graph is computed.</span>
<span class="sd">        skip_symmetry_check : bool</span>
<span class="sd">            If `True`, it will skip the check for symmetry of the matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The density of the graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;The matrix must be square!&quot;</span>
    <span class="n">n</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">adj</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="o">==</span><span class="s2">&quot;undirected&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_symmetry_check</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">adj</span><span class="o">!=</span><span class="n">adj</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">nnz</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The graph is directed. Taking the underlying undirected graph&quot;</span><span class="p">)</span>
                <span class="n">adj</span><span class="o">=</span><span class="n">underlying_undirected_matrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="o">==</span><span class="s2">&quot;reciprocal&quot;</span><span class="p">:</span>
        <span class="n">adj</span><span class="o">=</span><span class="n">rc_submatrix</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">adj</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span>  <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.efficient_rich_club_curve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">efficient_rich_club_curve</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;TOTAL&#39;</span><span class="p">,</span> <span class="n">pre_calculated_filtration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sparse_bin_set</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fast computation of the rich-club curve of the matrix M with respect to a degree filtration and possibly any filtration chosen by the user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>M</code>
            </td>
            <td>
                  <code>array_like or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code>str {&#39;OUT&#39;, &#39;IN&#39;, &#39;TOTAL&#39;}</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'OUT' : Compute the rich-club curve for the out-degree.</p>
<p>'IN' : Compute the rich-club curve for the in-degree.</p>
<p>'TOTAL' or None : Compute the rich-club curve for the total degree i.e., in-degree + out-degree.</p>
              </div>
            </td>
            <td>
                  <code>&#39;TOTAL&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pre_calculated_filtration</code>
            </td>
            <td>
                  <code>pandas series </code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>To provide user defined filtration values other than degree.<br />
The index are the nodes of M and values the filtration values.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sparse_bin_set</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False, all integer values between 0 and the maximum degree/filtration value will be used to generate the bins. 
If True, unique values of the degrees/filtration will be used. 
This is useful when the degrees/filtration values are sparse over the whole range.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Pandas series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>With index the center of the binned degrees/filtration and values the rich club coefficient at that degree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The rich-club coefficient is a measure of the tendency of high-degree nodes (nodes with a high filtration value) to form tightly interconnected communities.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">efficient_rich_club_curve</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;TOTAL&quot;</span><span class="p">,</span> <span class="n">pre_calculated_filtration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sparse_bin_set</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fast computation of the rich-club curve of the matrix M with respect to a degree filtration and possibly any filtration chosen by the user.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : array_like or sparse matrix</span>
<span class="sd">        Adjacency matrix of the graph.</span>
<span class="sd">    direction : str {&#39;OUT&#39;, &#39;IN&#39;, &#39;TOTAL&#39;}</span>
<span class="sd">        &#39;OUT&#39; : Compute the rich-club curve for the out-degree.</span>

<span class="sd">        &#39;IN&#39; : Compute the rich-club curve for the in-degree.</span>

<span class="sd">        &#39;TOTAL&#39; or None : Compute the rich-club curve for the total degree i.e., in-degree + out-degree.</span>
<span class="sd">    pre_calculated_filtration : pandas series </span>
<span class="sd">        To provide user defined filtration values other than degree.  </span>
<span class="sd">        The index are the nodes of M and values the filtration values.</span>
<span class="sd">    sparse_bin_set : bool</span>
<span class="sd">        If False, all integer values between 0 and the maximum degree/filtration value will be used to generate the bins. </span>
<span class="sd">        If True, unique values of the degrees/filtration will be used. </span>
<span class="sd">        This is useful when the degrees/filtration values are sparse over the whole range.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Pandas series</span>
<span class="sd">        With index the center of the binned degrees/filtration and values the rich club coefficient at that degree.</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The rich-club coefficient is a measure of the tendency of high-degree nodes (nodes with a high filtration value) to form tightly interconnected communities.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#TODO: Maybe expand the notes explaining this concept.</span>
    <span class="k">if</span> <span class="n">pre_calculated_filtration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">deg</span> <span class="o">=</span> <span class="n">pre_calculated_filtration</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">direction</span><span class="o">==</span><span class="s2">&quot;TOTAL&quot;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="n">deg</span><span class="o">=</span><span class="n">node_degree</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tocoo</span><span class="p">()</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">col</span><span class="p">})</span>



    <span class="k">if</span> <span class="n">sparse_bin_set</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">degree_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">deg</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sparse_bin_set</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">degree_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">deg</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">degree_bins_rv</span> <span class="o">=</span> <span class="n">degree_bins</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nrn_degree_distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">deg</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">degree_bins</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nrn_cum_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">nrn_degree_distribution</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">nrn_cum_pairs</span> <span class="o">=</span> <span class="n">nrn_cum_degrees</span> <span class="o">*</span> <span class="p">(</span><span class="n">nrn_cum_degrees</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">deg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">deg_arr</span><span class="p">[</span><span class="n">deg</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="o">=</span> <span class="n">deg</span><span class="o">.</span><span class="n">values</span>

    <span class="n">deg</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">con_degree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">deg_arr</span><span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="s2">&quot;row&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">deg_arr</span><span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
    <span class="n">M</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">con_degree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">con_degree</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">degree_bins</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">cum_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">con_degree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cum_degrees</span> <span class="o">/</span> <span class="n">nrn_cum_pairs</span><span class="p">,</span> <span class="n">degree_bins_rv</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.get_pairs_within" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pairs_within</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">max_dist</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns a matrix of the paris of nodes within distance <code>max_dist</code> of each other.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>array or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code><span title="DataFrame">DataFrame</span> or <span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with the coordinates of the nodes if m is square and has the same source and target nodes. 
If a tuple is passed, it should contain two DataFrames, one for the source nodes and one for the target nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns of the DataFrame containing the coordinates of the nodes.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;x&#39;, &#39;y&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum distance between nodes to be considered connected.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean matrix with 1 indicating the pairs of nodes within <code>max_dist</code> of each other, 
excluding the diagonal for square matrices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_pairs_within</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">max_dist</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a matrix of the paris of nodes within distance `max_dist` of each other.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : array or sparse matrix</span>
<span class="sd">            Adjacency matrix of the graph</span>
<span class="sd">        v : DataFrame or tuple</span>
<span class="sd">            DataFrame with the coordinates of the nodes if m is square and has the same source and target nodes. </span>
<span class="sd">            If a tuple is passed, it should contain two DataFrames, one for the source nodes and one for the target nodes.        </span>
<span class="sd">        cols : list</span>
<span class="sd">            Columns of the DataFrame containing the coordinates of the nodes.</span>
<span class="sd">        max_dist : float</span>
<span class="sd">            Maximum distance between nodes to be considered connected.        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sparse matrix</span>
<span class="sd">            Boolean matrix with 1 indicating the pairs of nodes within `max_dist` of each other, </span>
<span class="sd">            excluding the diagonal for square matrices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">vpre</span><span class="p">,</span> <span class="n">vpost</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vpre</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span> <span class="n">vpost</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">KDTree</span><span class="p">(</span><span class="n">vpre</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">query_ball_point</span><span class="p">(</span><span class="n">vpost</span><span class="p">[</span><span class="n">cols</span><span class="p">],</span> <span class="n">max_dist</span><span class="p">)</span>
    <span class="n">indptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span> <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">])</span>
    <span class="n">pairs_mat</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">indptr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">pairs</span><span class="p">),</span> <span class="n">indptr</span><span class="p">),</span>
                                   <span class="n">shape</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
        <span class="n">pairs_mat</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Don&#39;t consider edges from i to i when pre and post subpopulations are the same</span>
    <span class="k">if</span> <span class="n">indptr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">pairs_mat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.largest_strongly_connected_component" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">largest_strongly_connected_component</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the largest strongly connected component of the graph with adjacency matrix adjacency_matrix,
    and returns the adjacency matrix of said component</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adjacency_matrix</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the adjaceny matrix of the DiGraph as a numpy array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The adjacency matrix of the largest strongly connected component</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">largest_strongly_connected_component</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the largest strongly connected component of the graph with adjacency matrix adjacency_matrix,</span>
<span class="sd">        and returns the adjacency matrix of said component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adjacency_matrix : numpy array</span>
<span class="sd">        the adjaceny matrix of the DiGraph as a numpy array</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy array</span>
<span class="sd">        The adjacency matrix of the largest strongly connected component</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">):</span>
        <span class="n">adjacency_matrix</span> <span class="o">=</span> <span class="n">adjacency_matrix</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
    <span class="n">current_tribe_nx</span> <span class="o">=</span> <span class="n">np_to_nx</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">)</span>
    <span class="n">largest_comp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">(</span><span class="n">current_tribe_nx</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
    <span class="n">current_tribe_strong_nx</span> <span class="o">=</span> <span class="n">current_tribe_nx</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">largest_comp</span><span class="p">)</span>
    <span class="n">current_tribe_strong</span> <span class="o">=</span> <span class="n">nx_to_np</span><span class="p">(</span><span class="n">current_tribe_strong_nx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">current_tribe_strong</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.np_to_nx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">np_to_nx</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts numpy array of an adjacency matrix to a networkx digraph</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>adjacency_matrix</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the adjaceny matrix of the DiGraph as a numpy array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>networkx DiGraph</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a directed graph</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">np_to_nx</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts numpy array of an adjacency matrix to a networkx digraph</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    adjacency_matrix : numpy array</span>
<span class="sd">        the adjaceny matrix of the DiGraph as a numpy array</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    networkx DiGraph</span>
<span class="sd">            a directed graph</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">,</span><span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.nx_to_np" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nx_to_np</span><span class="p">(</span><span class="n">directed_graph</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts networkx digraph to numpy array of the adjacency matrix </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directed_graph</code>
            </td>
            <td>
                  <code>networkx DiGraph</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a directed graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the adjaceny matrix of the DiGraph as a numpy array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nx_to_np</span><span class="p">(</span><span class="n">directed_graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts networkx digraph to numpy array of the adjacency matrix </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    directed_graph : networkx DiGraph</span>
<span class="sd">        a directed graph</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy array</span>
<span class="sd">        the adjaceny matrix of the DiGraph as a numpy array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">directed_graph</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.connalysis.network.classic.rich_club_curve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rich_club_curve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;TOTAL&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute the rich-club curve of the matrix m.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code>array_like or sparse matrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjacency matrix of the graph.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code>str {&#39;OUT&#39;, &#39;IN&#39;, &#39;TOTAL&#39;}</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'OUT' : Compute the rich-club curve for the out-degree.</p>
<p>'IN' : Compute the rich-club curve for the in-degree.</p>
<p>'TOTAL' : Compute the rich-club curve for the total degree i.e., in-degree + out-degree.</p>
              </div>
            </td>
            <td>
                  <code>&#39;TOTAL&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Pandas series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>With index the center of the binned degrees and values the rich club coefficient at that degree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The rich-club coefficient is a measure of the tendency of high-degree nodes to form tightly interconnected communities.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/connalysis/network/classic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rich_club_curve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;TOTAL&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the rich-club curve of the matrix m.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : array_like or sparse matrix</span>
<span class="sd">        Adjacency matrix of the graph.</span>
<span class="sd">    direction : str {&#39;OUT&#39;, &#39;IN&#39;, &#39;TOTAL&#39;}</span>
<span class="sd">        &#39;OUT&#39; : Compute the rich-club curve for the out-degree.</span>

<span class="sd">        &#39;IN&#39; : Compute the rich-club curve for the in-degree.</span>

<span class="sd">        &#39;TOTAL&#39; : Compute the rich-club curve for the total degree i.e., in-degree + out-degree.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Pandas series</span>
<span class="sd">        With index the center of the binned degrees and values the rich club coefficient at that degree.</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The rich-club coefficient is a measure of the tendency of high-degree nodes to form tightly interconnected communities.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;TOTAL&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="n">degrees</span> <span class="o">=</span> <span class="n">node_degree</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">udegrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">degrees</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ret_x</span> <span class="o">=</span> <span class="n">udegrees</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ret_x</span><span class="p">,</span> <span class="n">udegrees</span><span class="p">,</span> <span class="n">degrees</span> <span class="o">=</span> <span class="n">_bin_degrees</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>

    <span class="n">edge_counter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">degrees</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="p">((</span><span class="n">degrees</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># number of pot. edges</span>
    <span class="n">mat_counter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">degrees</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">,</span> <span class="n">degrees</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># number of actual edges</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mat_counter</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">udegrees</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
           <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">edge_counter</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">udegrees</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">ret_x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;degree&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>